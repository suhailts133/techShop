<% layout("../layouts/profileboilerPlate") %>
  <title>
    <%= title %>
  </title>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">


  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.8/clipboard.min.js"></script>

  <div class="content">
    <div class="container mt-5">

      <% if (coupons.length===0) { %>
        <div class="alert alert-info">You don't have any coupons available</div>
      <% } else { %>
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
          <% coupons.forEach(coupon=> { %>
            <div class="col">
              <div class="card h-100 <%= coupon.status === 'Used' ? 'bg-light' : coupon.status === 'Expired' ? 'border-danger' : 'border-success' %>">
                <div class="card-body">
                  <div class="d-flex justify-content-between align-items-center mb-3">
                    <div class="input-group" style="max-width: 400px;">
                      <input type="text" 
                             class="form-control form-control-lg bg-light text-dark" 
                             id="couponCode" 
                             value="<%= coupon.code %>" 
                             readonly
                             style="font-weight: 600; letter-spacing: 2px;">
                      <div class="input-group-append">
                        <button class="btn btn-outline-dark" 
                                type="button" 
                                id="copyButton"
                                data-clipboard-target="#couponCode">
                          <i class="bi bi-copy"></i> 
                        </button>
                      </div>
                    </div>
                  </div>
      
                  <div class="mb-3">
                    <div class="fw-bold">Discount:</div>
                    ₹<%= coupon.discount %>
                  </div>
      
                  <div class="mb-3">
                    <div class="fw-bold">Minimum Purchase:</div>
                    ₹<%= coupon.minPurchase %>
                  </div>
      
                  <div class="text-muted small">
                    
                    
                      Expires: <%= moment(coupon.expiresAt).format('MMM Do YYYY') %>
                    
                      
                  </div>
                </div>
              </div>
            </div>
          <% }) %>
        </div>
     
        <div class="mt-3 text-muted small">
          <i class="bi bi-info-circle"></i> Expired coupons will be removed automatically.
        </div>
      <% } %>



  <script>
    new ClipboardJS("#copyButton");

    document.getElementById("copyButton").addEventListener('click', function() {
      const originalText = this.innerHTML;
      this.innerHTML = '<i class="bi bi-check2"></i> ';
      setTimeout(() => {
            this.innerHTML = originalText;
        }, 2000);
    })
  </script>

  <style>
    .input-group button {
        position: relative;
        margin-left: 10px;
        margin-top: 5px;
    }

    .input-group-append button {
        border-left: 0;
        background-color: #ffffff;
        color: #000000; 
        border: 1px solid #e0e0e0; 
    }
  </style>